from .uow_interface import UnitOfWork
from src.core.db_connection import get_session
from typing import Optional
from sqlalchemy.orm import Session
import logging

logger = logging.getLogger(__name__)

class SQLAlchemyUnitOfWork(UnitOfWork):
    '''–†–µ–∞–ª–∏–∑–∞—Ü–∏—è Unit of Work –¥–ª—è SQLAlchemy.'''
    def __init__(self, session_factory=None):
        '''
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Unit of Work.
        
        Args:
            session_factory: –§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–π –ë–î. –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω–∞,
                           –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è get_db_session.
        '''
        # –í—ã–±–∏—Ä–∞–µ–º —Ñ–∞–±—Ä–∏–∫—É —Å–µ—Å—Å–∏–π: –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–ª–∏ —Å–≤–æ—é - –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ—ë,
        # –µ—Å–ª–∏ –Ω–µ—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é get_db_session
        # –≠—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –≥–∏–±–∫–æ—Å—Ç–∏: –≤ —Ç–µ—Å—Ç–∞—Ö –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –¥—Ä—É–≥—É—é —Ñ–∞–±—Ä–∏–∫—É
        self._session_factory = session_factory or get_session
        
        # –°–µ—Å—Å–∏—è –ë–î. –ü–æ–∫–∞ None - —Å–æ–∑–¥–∞–¥–∏–º –ø–æ–∑–∂–µ, –∫–æ–≥–¥–∞ –≤–æ–π–¥–µ–º –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç (with)
        # Optional[Session] –æ–∑–Ω–∞—á–∞–µ—Ç "–º–æ–∂–µ—Ç –±—ã—Ç—å Session, –∞ –º–æ–∂–µ—Ç –±—ã—Ç—å None"
        # –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ None –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ—Å—Å–∏—è –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
        self._session: Optional[Session] = None
        self._session_context = None

    @property
    def session(self) -> Optional[Session]:
        '''–ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Å—Å–∏–∏ SQLAlchemy.'''
        return self._session

    def __enter__(self):
        '''
        –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä (–Ω–∞—á–∞–ª–æ –±–ª–æ–∫–∞ 'with').
        –ó–¥–µ—Å—å —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–µ—Å—Å–∏—è –ë–î –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –≤—Å–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
        '''
        # 1. –°–û–ó–î–ê–ï–ú –°–ï–°–°–ò–Æ –ë–î —á–µ—Ä–µ–∑ —Ñ–∞–±—Ä–∏–∫—É
        # self._session_factory - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–µ—Å—Å–∏–∏
        # –í—ã–∑—ã–≤–∞–µ–º –µ–µ —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Å–µ—Å—Å–∏–∏
        self._session_context = self._session_factory()
        
        # 2. "–í–•–û–î–ò–ú" –í –°–ï–°–°–ò–Æ - –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä
        # –ú–µ—Ç–æ–¥ __enter__() —Å–µ—Å—Å–∏–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–∞—á–∞–ª—å–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É:
        # - –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î
        # - –ù–∞—á–∏–Ω–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        # - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç —Å–µ—Å—Å–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã
        self._session = self._session_context.__enter__()
        
        # 3. –°–û–ó–î–ê–ï–ú –†–ï–ü–û–ó–ò–¢–û–†–ò–ò —Å –æ–±—â–µ–π —Å–µ—Å—Å–∏–µ–π
        # –ò–º–ø–æ—Ä—Ç—ã –∑–¥–µ—Å—å (–∞ –Ω–µ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞) —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
        from src.infrastructure.database.repositories import (
            ProductRepositoryImpl,
            PriceRepositoryImpl,
            UserRepositoryImpl,
            UserProductsRepositoryImpl,
        )
        
        # 4. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ò–†–£–ï–ú –†–ï–ü–û–ó–ò–¢–û–†–ò–ò
        # –ö–∞–∂–¥—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–ª—É—á–∞–µ—Ç –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å–µ—Å—Å–∏—é –ë–î
        # –≠—Ç–æ –≤–∞–∂–Ω–æ —á—Ç–æ–±—ã –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—ã–ª–∏ –≤ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
        self.product_repository = ProductRepositoryImpl(self._session)    # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤
        self.price_repository = PriceRepositoryImpl(self._session)        # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Ü–µ–Ω
        self.user_repository = UserRepositoryImpl(self._session)          # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        self.user_products_repository = UserProductsRepositoryImpl(self._session)
        
        # 5. –õ–û–ì–ì–ò–†–£–ï–ú —É—Å–ø–µ—à–Ω—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
        logger.info('Unit of Work –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å —Å–µ—Å—Å–∏–µ–π –∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏')
        
        # 6. –í–û–ó–í–†–ê–©–ê–ï–ú –°–ï–ë–Ø –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –±–ª–æ–∫–µ 'with'
        # –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å: with uow as u: u.products.get(...)
        return self
    
    def __exit__(self, exc_type, exc_val, exc_tb):
        '''
        –í—ã—Ö–æ–¥ –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–æ–∫–æ–Ω—á–∞–Ω–∏–µ –±–ª–æ–∫–∞ 'with').
        –ó–¥–µ—Å—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã: –∫–æ–º–º–∏—Ç –∏–ª–∏ –æ—Ç–∫–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
        
        Args:
            exc_type: –¢–∏–ø –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–µ—Å–ª–∏ –±—ã–ª–æ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ) –∏–ª–∏ None (–µ—Å–ª–∏ –≤—Å–µ OK)
            exc_val: –û–±—ä–µ–∫—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è (—Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ)
            exc_tb: Traceback –æ–±—ä–µ–∫—Ç (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –≥–¥–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞)
        '''
        try:
            # 1. –ü–†–û–í–ï–†–Ø–ï–ú –ë–´–õ–û –õ–ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–ï
            if exc_type is not None:
                # üö® –ë–´–õ–ê –û–®–ò–ë–ö–ê –≤ –±–ª–æ–∫–µ with - –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
                logger.warning(f'–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ Unit of Work: {exc_type.__name__}: {exc_val}')
                self.rollback()  # –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î
            else:
                # ‚úÖ –í–°–ï OK - –∫–æ–º–º–∏—Ç–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
                self.commit()    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î
                
        finally:
            # 2. –ë–õOCK FINALLY - –í–´–ü–û–õ–ù–Ø–ï–¢–°–Ø –í –õ–Æ–ë–û–ú –°–õ–£–ß–ê–ï
            # –î–∞–∂–µ –µ—Å–ª–∏ –≤—ã—à–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ commit() –∏–ª–∏ rollback()
            if self._session_context:
                # 3. –ö–û–†–†–ï–ö–¢–ù–û –ó–ê–ö–†–´–í–ê–ï–ú –°–ï–°–°–ò–Æ –ë–î
                # –ú–µ—Ç–æ–¥ __exit__ —Å–µ—Å—Å–∏–∏:
                # - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ë–î
                # - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã
                # - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Å–µ—Å—Å–∏–∏
                self._session_context.__exit__(exc_type, exc_val, exc_tb)
                
                # 4. –û–ß–ò–°–¢–ö–ê –†–ï–°–£–†–°–û–í (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
                self._session = None          # –£–±–∏—Ä–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Å–µ—Å—Å–∏—é
                self._session_context = None  # –£–±–∏—Ä–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç
                
                logger.info("Unit of Work –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É, —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞")

    def commit(self):
        '''
        –§–∏–∫—Å–∞—Ü–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ë–î.
        –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (INSERT, UPDATE, DELETE) –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.
        '''
    # 1. –ü–†–û–í–ï–†–Ø–ï–ú —á—Ç–æ —Å–µ—Å—Å–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∞–∫—Ç–∏–≤–Ω–∞
    # –≠—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ commit() –≤—ã–∑—ã–≤–∞—é—Ç –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
        if self._session:
            try:
                # 2. –í–´–ü–û–õ–ù–Ø–ï–ú COMMIT - —Ñ–∏–∫—Å–∏—Ä—É–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î
                # üíæ –≠—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –∫–æ–≥–¥–∞ –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º–∏
                self._session.commit()
                logger.info('Unit of Work: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞, commit –≤—ã–ø–æ–ª–Ω–µ–Ω')
                
            except Exception as e:
                # 3. –û–ë–†–ê–ë–ê–¢–´–í–ê–ï–ú –û–®–ò–ë–ö–ò –ø—Ä–∏ –∫–æ–º–º–∏—Ç–µ
                # üö® –ï—Å–ª–∏ commit –Ω–µ —É–¥–∞–ª—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞—Ä—É—à–µ–Ω–∏–µ constraints –ë–î)
                logger.error(f'Unit of Work: –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞, commit –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω. –û—à–∏–±–∫–∞: {e}')
                
                # 4. –í–´–ü–û–õ–ù–Ø–ï–ú ROLLBACK –ø—Ä–∏ –æ—à–∏–±–∫–µ –∫–æ–º–º–∏—Ç–∞
                # üîÑ –û—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —á—Ç–æ–±—ã –Ω–µ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –ø–æ–¥–≤–µ—à–µ–Ω–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
                self.rollback()
                
                # 5. –í–´–ó–û–í–ï–ú –∏—Å–∫–ª—é—á–µ–Ω–∏–µ 
                raise
        else:
            # 6. –°–õ–£–ß–ê–ô –∫–æ–≥–¥–∞ —Å–µ—Å—Å–∏–∏ –Ω–µ—Ç (–∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
            logger.warning('Unit of Work: –ü–æ–ø—ã—Ç–∫–∞ commit –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ë–î')

    def rollback(self):
        '''
        –û—Ç–∫–∞—Ç –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ç–µ–∫—É—â–µ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
        –û—Ç–º–µ–Ω—è–µ—Ç –≤—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (INSERT, UPDATE, DELETE) —Å –º–æ–º–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ commit.
        –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –±—ã–ª–æ –¥–æ –Ω–∞—á–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
        '''
        # 1. –ü–†–û–í–ï–†–Ø–ï–ú —á—Ç–æ —Å–µ—Å—Å–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∞–∫—Ç–∏–≤–Ω–∞
        # üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ rollback() –≤—ã–∑—ã–≤–∞—é—Ç –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏
        if self._session:
            try:
                # 2. –í–´–ü–û–õ–ù–Ø–ï–ú ROLLBACK - –æ—Ç–∫–∞—Ç—ã–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î
                # üîÑ –≠—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –∫–æ–≥–¥–∞ –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç–º–µ–Ω—è—é—Ç—Å—è
                # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ –Ω–∞—á–∞–ª–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
                self._session.rollback()
                logger.info('Unit of Work: —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –æ—Ç–∫–∞—á–µ–Ω–∞, rollback –≤—ã–ø–æ–ª–Ω–µ–Ω')
                
            except Exception as e:
                # 3. –û–ë–†–ê–ë–ê–¢–´–í–ê–ï–ú –û–®–ò–ë–ö–ò –ø—Ä–∏ rollback
                # üö® CRITICAL: –ï—Å–ª–∏ rollback –Ω–µ —É–¥–∞–ª—Å—è - —ç—Ç–æ —Å–µ—Ä—å–µ–∑–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞!
                # –≠—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –ë–î –∏–ª–∏ corruption —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
                logger.error(f'Unit of Work: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê - –Ω–µ —É–¥–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å rollback. –û—à–∏–±–∫–∞: {e}')
                
                # 4. –í–´–ó–´–í–ê–ï–ú –∏—Å–∫–ª—é—á–µ–Ω–∏–µ 
                raise
        else:
            # 5. –°–õ–£–ß–ê–ô –∫–æ–≥–¥–∞ —Å–µ—Å—Å–∏–∏ –Ω–µ—Ç (–∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
            logger.warning('–ü–æ–ø—ã—Ç–∫–∞ rollback –±–µ–∑ –∞–∫—Ç–∏–≤–Ω–æ–π —Å–µ—Å—Å–∏–∏ –ë–î - –Ω–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–∫–∞—Ç–∞')