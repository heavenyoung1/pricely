from aiogram.types import Message

from src.domain.entities import User
from src.infrastructure.services import product_service
from src.infrastructure.services import logger

async def command_start_handler(message: Message) -> None:
    user = User(
        id=str(message.from_user.id),
        username=message.from_user.username,
        chat_id=str(message.chat.id), #–û—Ç —ç—Ç–æ–≥–æ –ø–æ–ª—è –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∏–∑–±–∞–≤–∏—Ç—å—Å—è!!!
    )
    try:
        product_service.create_user(user)
        logger.info(f'–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å {user.id} —Å–æ–∑–¥–∞–Ω –∏–ª–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç')
    except Exception as e:
        logger.warning(f'–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user.id}: {e}')

    await message.answer(f'üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {message.from_user.full_name}! –Ø –±–æ—Ç –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ü–µ–Ω Ozon.')