def format_categories(categories) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
    if not categories:
        return "‚Äî"
    
    # –ï—Å–ª–∏ —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ {cat1,cat2,"cat3"}
    if isinstance(categories, str):
        if categories.startswith('{') and categories.endswith('}'):
            # –£–±–∏—Ä–∞–µ–º —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ –∏ —Ä–∞–∑–¥–µ–ª—è–µ–º –ø–æ –∑–∞–ø—è—Ç—ã–º
            categories_list = [cat.strip().strip('"') for cat in categories.strip('{}').split(',')]
            return ' ‚Üí '.join(categories_list)
        else:
            return categories
    
    # –ï—Å–ª–∏ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ –∏–ª–∏ –∫–æ—Ä—Ç–µ–∂
    elif isinstance(categories, (list, tuple)):
        return " ‚Üí ".join(str(cat) for cat in categories)
    
    # –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∫ —Å—Ç—Ä–æ–∫—É
    return str(categories)

def format_product_message(product: dict) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–≤–∞—Ä–µ –¥–ª—è Telegram (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å).
    """
    # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Ü–µ–Ω—É –∏–∑ —Å–ø–∏—Å–∫–∞ prices –∏–ª–∏ –∏–∑ latest_price
    latest_price = None
    
    if "latest_price" in product and product["latest_price"]:
        latest_price = product["latest_price"]
    elif "prices" in product and product["prices"]:
        # –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ —Ü–µ–Ω (—Å–∞–º—ã–π –Ω–æ–≤—ã–π)
        latest_price = product["prices"][-1]
        # –ï—Å–ª–∏ —ç—Ç–æ –æ–±—ä–µ–∫—Ç Price, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —Å–ª–æ–≤–∞—Ä—å
        if hasattr(latest_price, '__dict__'):
            latest_price = {
                'with_card': latest_price.with_card,
                'without_card': latest_price.without_card,
                'created_at': latest_price.created_at
            }
    
    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ü–µ–Ω—ã
    if latest_price:
        with_card = latest_price.get('with_card', '‚Äî')
        without_card = latest_price.get('without_card', '‚Äî')
        if with_card and with_card != '‚Äî':
            with_card = f"{with_card} ‚ÇΩ"
        if without_card and without_card != '‚Äî':
            without_card = f"{without_card} ‚ÇΩ"
    else:
        with_card = "‚Äî"
        without_card = "‚Äî"
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    text = (
        f"üì¶ {product.get('name', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–æ–≤–∞—Ä')}\n"
        f"üí≥ –¶–µ–Ω–∞ —Å –∫–∞—Ä—Ç–æ–π: {with_card}\n"
        f"üíµ –¶–µ–Ω–∞ –±–µ–∑ –∫–∞—Ä—Ç—ã: {without_card}\n"
        f"üîó <a href='{product.get('link', '#')}'>–°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä</a>"
    )
    
    return text